<!DOCTYPE html>
    <html>
    <head>
        <meta http-equiv="Content-type" content="text/html; charset=utf-8">
        <meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=no">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <meta charset="utf-8">
        <meta name="keywords" content="">
        <meta name="description" content="">
        <meta name="page_type" content="np-template-header-footer-from-plugin">
        <title>ציונים</title>
        <link href="../Style/nicepage3.css" rel="stylesheet" />
        <link href="../Style/Createclass.css" rel="stylesheet" />
        <link href="../Style/additionalStyle.css" rel="stylesheet" />
        <link href="../Style/ExistingClassStyle.css" rel="stylesheet" />

        <meta name="generator" content="Nicepage 3.8.1, nicepage.com">
        <link id="u-theme-google-font" rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:100,100i,300,300i,400,400i,500,500i,700,700i,900,900i|Open+Sans:300,300i,400,400i,600,600i,700,700i,800,800i">
        <!-- שורות בוטסאראפ -->
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css">
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.16.0/umd/popper.min.js"></script>
        <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js"></script>
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.16.0/umd/popper.min.js"></script>
        <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
        <script src="https://unpkg.com/sweetalert/dist/sweetalert.min.js"></script>
        <!--<script src="https://code.jquery.com/jquery-1.10.2.js"></script>-->
        <script type="application/ld+json">
            {
            "@context": "http://schema.org",
            "@type": "Organization",
            "name": "Site1",
            "url": "index.html"
            }
        </script>
        <link rel="icon" href="../images/alienIcon.png">

        <!--file scripts-->
        <link href="../Style/additionalStyle.css" rel="stylesheet" />
        <script src="https://igniteui.com/js/modernizr.min.js"></script>
        <script src="https://code.jquery.com/jquery-1.9.1.min.js"></script>
        <script src="https://code.jquery.com/ui/1.10.3/jquery-ui.min.js"></script>
        <script src="https://cdn-na.infragistics.com/igniteui/latest/js/infragistics.core.js"></script>
        <script src="https://cdn-na.infragistics.com/igniteui/latest/js/infragistics.lob.js"></script>
        <script src="https://cdn-na.infragistics.com/igniteui/latest/js/modules/infragistics.ext_core.js"></script>
        <script src="https://cdn-na.infragistics.com/igniteui/latest/js/modules/infragistics.ext_collections.js"></script>
        <script src="https://cdn-na.infragistics.com/igniteui/latest/js/modules/infragistics.ext_text.js"></script>
        <script src="https://cdn-na.infragistics.com/igniteui/latest/js/modules/infragistics.ext_io.js"></script>
        <script src="https://cdn-na.infragistics.com/igniteui/latest/js/modules/infragistics.ext_ui.js"></script>
        <script src="https://cdn-na.infragistics.com/igniteui/latest/js/modules/infragistics.documents.core_core.js"></script>
        <script src="https://cdn-na.infragistics.com/igniteui/latest/js/modules/infragistics.ext_collectionsextended.js"></script>
        <script src="https://cdn-na.infragistics.com/igniteui/latest/js/modules/infragistics.excel_core.js"></script>
        <script src="https://cdn-na.infragistics.com/igniteui/latest/js/modules/infragistics.ext_threading.js"></script>
        <script src="https://cdn-na.infragistics.com/igniteui/latest/js/modules/infragistics.ext_web.js"></script>
        <script src="https://cdn-na.infragistics.com/igniteui/latest/js/modules/infragistics.xml.js"></script>
        <script src="https://cdn-na.infragistics.com/igniteui/latest/js/modules/infragistics.documents.core_openxml.js"></script>
        <script src="https://cdn-na.infragistics.com/igniteui/latest/js/modules/infragistics.excel_serialization_openxml.js"></script>
        <link href="https://cdn-na.infragistics.com/igniteui/latest/css/themes/infragistics/infragistics.theme.css" rel="stylesheet"></link>
        <link href="https://cdn-na.infragistics.com/igniteui/latest/css/structure/infragistics.css" rel="stylesheet"></link>

        <script src="../Scripts/ajaxCalls.js"></script>
        <style type="text/css">

            button {
                border: 1px solid #58008bf7;
                background-color: #cbdcea;
                border-radius: 7px;
            }

                button:hover {
                    background-color: #9c55a3ad;
                    /*color: red;*/
                }

            button#gradesBtn {
                font-family: calibri;
                font-size: larger;
                background-color: #4897aab8;
                font-weight: bolder;
                color: white;
            }

                button#gradesBtn:hover {
                    background-color: #4897aa;
                }

            button.BackBtn {
                position: absolute;
                top: 30px;
                right: -267px;
            }

            table {
                font-family: tahoma;
                border-collapse: collapse;
                width: 90%;
                margin: 0 auto;
                margin-bottom: 50px;
                /*margin-top: 40px;*/
            }

            td, th {
                border: 1px solid #dddddd;
                text-align: center;
                padding: 8px;
            }

            .edittd .editrow {
                border: 1px solid black;
            }

            tr:nth-child(even) {
                background-color: #dddddd;
            }

            .form-group.row {
                flex-direction: row-reverse;
            }

            form#examForm {
                display: flex;
                flex-direction: column;
                align-items: flex-end;
            }

            .form-control {
                text-align: end;
            }

        </style>
        

        <!--<script type="text/javascript" src="https://code.jquery.com/jquery-3.3.1.js"></script>
        <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
        <script type="text/javascript" src="https://cdn.datatables.net/1.10.19/js/jquery.dataTables.min.js"></script>
        <script type="text/javascript" src="https://cdn.datatables.net/responsive/2.2.3/js/dataTables.responsive.min.js"></script>
        <script type="text/javascript" src="https://cdn.datatables.net/1.10.19/js/dataTables.bootstrap.min.js"></script>
        <script src="https://unpkg.com/sweetalert/dist/sweetalert.min.js"></script>
        <script src="https://code.jquery.com/jquery-3.5.1.js"></script>-->

        <script src="../Scripts/ajaxCalls.js"></script>
        <meta charset="utf-8" />

        <script>
            $(document).ready(function () {
                classId = JSON.parse(localStorage.getItem('idClass')); //save class id
                classDetails();
                CheckExams();

                //$(document).on("click", "#cancleBTN", function () { $("#editDiv").hide(); });
                $(document).on("click", ".editexamdbtn", EditExamDetails);
                $(document).on("click", ".viewexambtn", ViewExamDetails);
                $("#editDiv").hide();
                
                $(document).on("submit", "#examForm", onSubmitFunc);
                $("#gradesBtn").click(function () { window.location.href = "StudentGraph.html"; })
                $("#Rules").click(btnNavClick);
                $("#Student").click(btnNavClick);               
                $(".BackBtn").on("click", function () { window.location.href = "TeacherClasses.html"; });

                $("#saveExcel").click(postt);               

                

                dataGrades = [];
                examsData = [];

            //from here
                //טעינה מקובץ אקסל
                $("#input").on("change", function () {
                    var excelFile,
                        fileReader = new FileReader();

                    $("#result").hide();

                    fileReader.onload = function (e) {
                        var buffer = new Uint8Array(fileReader.result);

                        $.ig.excel.Workbook.load(buffer, function (workbook) {
                            var column, row, newRow, cellValue, columnIndex, i,
                                worksheet = workbook.worksheets(0),
                                columnsNumber = 0,
                                gridColumns = [],
                                data = [],
                                worksheetRowsCount;

                            // Both the columns and rows in the worksheet are lazily created and because of this most of the time worksheet.columns().count() will return 0
                            // So to get the number of columns we read the values in the first row and count. When value is null we stop counting columns:
                            while (worksheet.rows(0).getCellValue(columnsNumber)) {
                                columnsNumber++;
                            }

                            // Iterating through cells in first row and use the cell text as key and header text for the grid columns
                            for (columnIndex = 0; columnIndex < columnsNumber; columnIndex++) {
                                column = worksheet.rows(0).getCellText(columnIndex);
                                gridColumns.push({ headerText: column, key: column }); //לשמור את הכותרות
                            }


                            // We start iterating from 1, because we already read the first row to build the gridColumns array above
                            // We use each cell value and add it to json array, which will be used as dataSource for the grid
                            for (i = 1, worksheetRowsCount = worksheet.rows().count(); i < worksheetRowsCount; i++) {
                                newRow = {};
                                row = worksheet.rows(i);
                                examsArr = [];
                                for (columnIndex = 0; columnIndex < columnsNumber; columnIndex++) {
                                    cellValue = row.getCellText(columnIndex);
                                    newRow[gridColumns[columnIndex].key] = cellValue; //switch case (0,1,2,3,4,5..)
                                    switch (columnIndex) {
                                        case 0: {
                                            firstnameCol = cellValue;
                                            break;
                                        }
                                        case 1: {
                                            lastnameCol = cellValue;
                                            break;
                                        }
                                        case 2: {
                                            Email = cellValue;
                                            break;
                                        }
                                        case 3: {
                                            e = {
                                                ExamNum: 1,
                                                Grade: cellValue
                                            }
                                            examsArr.push(e)
                                            break;
                                        }
                                        case 4: {
                                            e = {
                                                ExamNum: 2,
                                                Grade: cellValue
                                            }
                                            examsArr.push(e)
                                            break;
                                        }
                                        case 5: {
                                            e = {
                                                ExamNum: 3,
                                                Grade: cellValue
                                            }
                                            examsArr.push(e)
                                            break;
                                        }
                                        case 6: {
                                            e = {
                                                ExamNum: 4,
                                                Grade: cellValue
                                            }
                                            examsArr.push(e)
                                            break;
                                        }
                                        case 7: {
                                            e = {
                                                ExamNum: 5,
                                                Grade: cellValue
                                            }
                                            examsArr.push(e)
                                            break;
                                        }

                                        default: {
                                            break;
                                        }
                                    }
                                }

                                dataGrades.push({
                                    "Email": Email,
                                    "First_name": firstnameCol,
                                    "Last_name": lastnameCol,
                                    "IdClass": classId,
                                    "AllExam": examsArr
                                });

                                data.push(newRow);
                            }

                            getExamsSuccess(dataGrades);

                        }, function (error) {
                            $("#result").text("The excel file is corrupted.");
                            $("#result").show(1000);
                        });
                    }

                    if (this.files.length > 0) {
                        excelFile = this.files[0];
                        if (excelFile.type === "application/vnd.ms-excel" || excelFile.type === "application/vnd.openxmlformats-officedocument.spreadsheetml.sheet" || (excelFile.type === "" && (excelFile.name.endsWith("xls") || excelFile.name.endsWith("xlsx")))) {
                            fileReader.readAsArrayBuffer(excelFile);
                        } else {
                            $("#result").text("The format of the file you have selected is not supported. Please select a valid Excel file ('.xls, *.xlsx').");
                            $("#result").show(1000);
                        }
                    }

                    $(".next").prop('disabled', false);
                    $(".next").addClass("nextReady");
                })

            }); //close ready


            function classDetails() {

                let url = "../api/Classes/GetDetails?idClass=" + classId;
                ajaxCall("Get", url, "", GetDetailsSuccess, GetDetailsError);
            }

            function GetDetailsSuccess(data) {
                console.log(data);
                classdet = data;
                if (classdet.Classnum == 0) {/* כיתה מקצועית*/
                    str = classdet.Subjname + " כיתה " + classdet.Layer + " הקבצה " + classdet.Levelgroup + " קבוצה " + classdet.Groupnum;
                    $("#classHead").html(str);
                }

                else {
                    ///כיתת אם/
                    str = classdet.Subjname + " כיתה " + classdet.Layer + "'" + classdet.Classnum;
                    $("#classHead").html(str);
                }
            }

            function GetDetailsError(err) {
                console.log(err);
            }

            //to here


            function btnNavClick() {
                idBtnNav = $(this).attr('id');
                let id = JSON.stringify(idBtnNav);
                localStorage.setItem("idBtn", id);
                window.location.href = "ExistingClass.html";
            }

            function onSubmitFunc() {
                //לבדוק מה קורה כשיש יותר ממבחן 1 שעודכן
                examAfterEdit = [];

                $(".examsClass").each(function () {
                    element = $(this);

                    examAfterEdit.push({
                        "IdClass": exam.IdClass,
                        "StudentEmail": exam.Email,
                        "Grade": element.val(),
                        "ExamNum": element.attr("id").trim().split('m')[1]
                    });
                });

                let url = "../api/Students/updateExams?email=" + exam.Email;
                ajaxCall("PUT", url, JSON.stringify(examAfterEdit), PutExamsSuccess, PutExamsError);
                return false;
            }

            function PutExamsSuccess(data) {
                console.log(data);
                swal("!הנתונים נשמרו במערכת", "", "success")
                    .then((value) => {
                        $("#editDiv").hide();
                        CheckExams();
                    });
            }

            function PutExamsError(err) {
                console.log(err);
            }
            function postt() {
                let url = "../api/Students/FromExcel";
                ajaxCall("POST", url, JSON.stringify(dataGrades), PostaddExamSuccess, PostaddExamError);
                return false;
            }

            function PostaddExamSuccess(data) {
                console.log(data);
                swal("הנתונים נשמרו במערכת");
            }            


            function PostaddExamError(err) {
                console.log(err);
            }

            //שליפת ציונים
            function CheckExams() {
                let url = "../api/Classes/getExams?idClass=" + classId;
                ajaxCall("GET", url, "", getExamsSuccess, getExamsError);
                return false;
            }

            function getExamsSuccess(data) {
                //להציג את הציונים
                str = "";
                examsData = [];
                maxLength = 0;

                for (var i = 0; i < data.length; i++) {

                    if (data[i].AllExam.length > maxLength)
                        maxLength = data[i].AllExam.length;
                }

                for (var i = 0; i < data.length; i++) {
                    if (data[i].AllExam.length < maxLength) { //some of the grades
                        maxIndex = data[i].AllExam.length;
                        examnumsArr = [];
                        examnumsArr.length = maxLength;
                        if (maxIndex == 0) {
                            for (maxIndex; maxIndex < maxLength; maxIndex++) {
                                e = {
                                    ExamNum: (maxIndex + 1),
                                    Grade: 0
                                };
                                data[i].AllExam.push(e);
                            }
                        }
                        else {
                            for (var j = 0; j < maxLength; j++) {
                                if (data[i].AllExam[j] != null) {
                                    examnumsArr[(data[i].AllExam[j].ExamNum) - 1] = data[i].AllExam[j].ExamNum;
                                }
                            }
                            var index = 0;
                            var ExamList = [];
                            for (var j = 0; j < maxLength; j++) {
                                if (examnumsArr[j] == 0 || examnumsArr[j] == null) {
                                    e = {
                                        ExamNum: (j + 1),
                                        Grade: 0
                                    };
                                }
                                else {
                                    e = {
                                        ExamNum: (j + 1),
                                        Grade: data[i].AllExam[index].Grade //data[i]
                                    };
                                    index++;
                                }
                                ExamList.push(e);
                            }
                            data[i].AllExam = ExamList;
                        }
                    }
                    examsData.push(data[i]);
                }

                str += "<table id='gradesTable'>";
                str += "<tr>";               
                str += "<th>אימייל</th>";
                str += "<th>שם משפחה</th>";
                str += "<th>שם פרטי</th>";
                str += "<th> </th>";
                str += "</tr>";
                for (var i = 0; i < examsData.length; i++) {
                    str += "<tr>";
                    str += "<td>" + examsData[i].Email + "</td>";
                    str += "<td>" + examsData[i].Last_name + "</td>";
                    str += "<td>" + examsData[i].First_name + "</td>";
                    str += "<td><button id='editbtn_" + i + "' class='editexamdbtn'>ערוך</button>";
                    str += " <button id='viewbtn_" + i + "' class='viewexambtn'>צפה בציונים</button></td>";
                    str += "</tr>";
                }
                
                str += "</table>";

                $("#StudExams").html(str);
            }

            function EditExamDetails() {
                markSelected(this);
                $("#editDiv").show();
                idEmailStu = examsData[$(this).attr('id').trim().split("_")[1]].Email;
                populateFields(idEmailStu);
                document.getElementById("lastname").disabled = true;
                document.getElementById("firsname").disabled = true;
                document.getElementById("exam1").disabled = false;
                document.getElementById("exam2").disabled = false;
                document.getElementById("exam3").disabled = false;
            }

            function ViewExamDetails() {
                markSelected(this);
                $("#editDiv").show();
                $("#editDiv :input").attr("disabled", "disabled");
                idEmailStu = examsData[$(this).attr('id').trim().split("_")[1]].Email;
                populateFields(idEmailStu);
            }


            // mark the selected row
            function markSelected(btn) {
                $("#examsTable tr").removeClass("selected"); // remove seleced class from rows that were selected before
                row = (btn.parentNode).parentNode; // button is in TD which is in Row
                row.className = 'selected'; // mark as selected
            }



            //fill the form fields
            function populateFields(examId) {
                exam = getExam(examId);
                $("#lastname").val(exam.Last_name);
                $("#firsname").val(exam.First_name);
                for (var i = 0; i < exam.AllExam.length; i++) {

                    $("#exam" + (exam.AllExam[i].ExamNum)).val(exam.AllExam[i].Grade);

                }


            }

            //// get a exam according to its Id
            function getExam(email) {
                for (i in examsData) {
                    if (examsData[i].Email == email)
                        return examsData[i];
                }
                return null;
            }



            function getExamsError(err) {
                console.log(err);
            }
        </script>
    </head>
    <body>
        <header class="u-align-left u-clearfix u-grey-60 u-header u-header" id="sec-4dba">
            <div class="u-clearfix u-sheet u-sheet-1">
                <h1 id="classHead" class="u-text u-text-1"></h1>
                <button class="BackBtn">הכיתות שלי</button>
                <span class="u-icon u-icon-circle u-text-white u-icon-1">
                    <svg class="u-svg-link" preserveAspectRatio="xMidYMin slice" viewBox="0 0 512 512" style=""><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#svg-4e0d"></use></svg><svg class="u-svg-content" id="svg-4e0d">
                        <g>
                            <path d="m97.9 84.9c1.3 0 2.7-.4 3.8-1.3 3.8-3 7.7-6 11.7-8.8 2.7-1.9 3.4-5.6 1.5-8.4-1.9-2.7-5.6-3.4-8.4-1.5-4.2 2.9-8.3 6.1-12.3 9.3-2.6 2.1-3 5.9-.9 8.4 1.1 1.6 2.8 2.3 4.6 2.3z"></path>
                            <path d="m26.4 179.6c.7.3 1.4.4 2.1.4 2.4 0 4.7-1.5 5.6-3.9 11-28.9 27.9-54.9 50.2-77.1 2.4-2.3 2.4-6.1 0-8.5-2.3-2.4-6.1-2.4-8.5 0-23.5 23.4-41.4 50.8-53 81.3-1 3.2.5 6.6 3.6 7.8z"></path>
                            <path d="m437 362.8c-2.8-1.7-6.5-.8-8.2 2.1-3.4 5.6-7 11.2-10.9 16.5-2 2.7-1.4 6.4 1.3 8.4 1.1.8 2.3 1.2 3.5 1.2 1.9 0 3.7-.9 4.9-2.5 4.1-5.6 8-11.5 11.5-17.4 1.7-3 .8-6.6-2.1-8.3z"></path>
                            <path d="m462.2 318.1c3.4-11.6 5.9-23.6 7.4-35.7 1.2-9.5 1.8-19.3 1.8-28.9 0-3.3-2.7-6-6-6s-6 2.7-6 6c0 9.2-.6 18.4-1.7 27.4-1.4 11.4-3.8 22.8-7 33.8-2 6.7-4.3 13.4-6.9 19.9-1.6 4-3.3 7.9-5.2 11.8-1.4 3-.1 6.6 2.9 8 .8.4 1.7.6 2.6.6 2.2 0 4.4-1.3 5.4-3.4 1.9-4.1 3.8-8.3 5.5-12.5 2.7-6.9 5.1-13.9 7.2-21z"></path>
                            <path d="m132.4 63.6c3.8 0 6.9-3.1 6.9-6.9s-3.1-6.9-6.9-6.9-6.9 3.1-6.9 6.9 3.1 6.9 6.9 6.9z"></path>
                            <path d="m406.2 396.5c-3.8 0-6.9 3.1-6.9 6.9s3.1 6.9 6.9 6.9 6.9-3.1 6.9-6.9-3.1-6.9-6.9-6.9z"></path>
                            <path d="m436.1 229.5c-5.6-5.1-7-13.4-3.6-20 46.4-39.1 73.7-98.5 70.7-162-.2-3.3-2.9-5.9-6.3-5.7-44.7 2.1-86.3 18.6-120.5 47.8-3.5 3-7 6.2-10.3 9.4-35.6-28.9-80.3-44.8-126.5-44.8-110.4 0-200.2 89.3-200.2 199.1 0 26.5 5.2 52.2 15 75.9-41.1 58.9-54.4 98.8-40.7 122 7.8 13.1 24.1 19.9 47.6 19.9 5.3 0 11-.3 17-1 17.2-2 34.6-6.7 51.7-14 12.7-5.4 24.7-11.3 36.2-17.4 23.4 9.2 48.1 13.9 73.6 13.9 51.2 0 99.9-19.2 137.2-54.1 36.6-34.3 58.7-80.3 62.5-130 9.1-11.7 7.8-28.8-3.4-39zm55.3-175.3c.1 9.8-.5 19.5-1.8 29-10.8-5.9-20.1-14.3-27-24.5 9.4-2.2 19-3.7 28.8-4.5zm-107.1 44.6c19.7-16.9 42.1-29.2 66.2-36.7 8.8 14.4 21.7 26.1 36.9 33.5-13.5 63.9-59.8 117.7-123.7 139.1l-40.4-36.8c9.3-38.2 30.8-73.3 61-99.1zm-72.1 128.1 19.6-5.1 8.6 7.8-3.9 19.4zm3.8 31.8c0 .7 0 1.5-.2 2.2-.7 3.1-3.2 5.4-6.3 6l-10 1.7.8-10.1c.2-3.2 2.5-6 5.6-6.9.6-.2 1.3-.3 1.9-.3h.4c2 0 3.8.7 5.3 2.1 1.5 1.3 2.4 3.2 2.5 5.3zm-2-72.4c-10.3 9.7-26.7 10-37.4.4l-18.3-16.5 31.9-34.5c3-3.3 7.1-5.2 11.6-5.5 4.5-.2 8.8 1.3 12.1 4.3 5.4 4.9 12.2 7.4 19.1 7.4-8.1 14-14.5 28.9-19 44.4zm-74.3-119.9c43.1 0 84.8 14.7 118.2 41.5-5.6 6.2-10.7 12.7-15.5 19.5-6.3 4.1-14.8 3.5-20.4-1.6-5.7-5.2-13-7.8-20.7-7.5-7.7.4-14.7 3.7-19.9 9.3l-36 39c-1.1 1.2-1.7 2.7-1.6 4.3s.8 3.1 2 4.2l22.9 20.5c7.5 6.8 17 10.1 26.5 10.1 5.5 0 11-1.1 16.1-3.4l10 9.9-16.7 4.4c-1.6.4-3.1 1-4.5 1.7-3 1.5-5.6 3.9-7.6 6.6-9.9 13.2-28.6 37.7-51.5 64.6l-12.7-17.2c-7-9.7-17.8-15.3-28.9-15.1l-20.5-12.2c-7.8-4.7-17.6-4.9-25.6-.6l-10.9 5.8c-7.1 3.8-16 1.4-20.3-5.3l-10.6-16.6c-3.6-5.7-3.5-12.9.3-18.5 4.3-6.2 11.6-9.5 19.1-8.6l15.9 2c8.2 1 16.1-2.8 20.1-9.7 3.9-6.6 11.3-10.2 18.9-9.3l6.9.9c7 .9 14.1-2 18.4-7.6l6.1-7.9c7.1-9.2 7.5-21.8.8-31.4l-13.2-18.9c-5.5-7.9-12.9-14.7-21.2-19.5-1.8-1.1-3.6-2.2-5.2-3.5l-17.2-12.9c23.9-10.9 50.5-17 78.5-17zm-90.6 23.1 22.1 16.5c2 1.5 4.2 2.9 6.4 4.2 6.9 4 12.9 9.5 17.4 16l13.2 18.9c3.7 5.2 3.5 12.2-.4 17.2l-6.1 7.9c-1.7 2.2-4.6 3.4-7.4 3.1l-6.9-.9c-12.4-1.6-24.5 4.4-30.8 15.1-1.6 2.7-4.9 4.3-8.2 3.8l-15.9-2c-12-1.5-23.7 3.7-30.5 13.7-6.5 9.5-6.7 21.9-.5 31.7l10.6 16.6c7.6 12 23.5 16.1 36.1 9.4l10.9-5.8c4.3-2.3 9.6-2.2 13.9.3l20.7 12.3c1.8 1.1 3.9 1.6 6 1.6 7.2-.2 14.4 3.6 19.1 10.2l14.5 19.4c-3 3.5-6.2 7-9.3 10.5-17.5 19.4-33.8 36.1-49 49.9l-24.9-33c-1.6-2-2.7-4.3-3.4-6.8l-7.4-26.6c-3.2-11.4-12.3-20.5-23.8-23.6l-1.6-.4c-2.3-.6-4.5-1.8-6.2-3.5l-13.8-12.9c-1.8-1.7-3.3-3.5-4.5-5.6-7.4-12.6-21.5-19.6-35.8-18 7.5-59.9 44.3-111.1 95.5-139.2zm-97.6 164c0-4.1.2-8.2.4-12.3l.6-.1c10.3-2 20.8 2.7 26.2 11.8 1.8 3.1 4 5.9 6.7 8.3l13.8 12.9c3.2 3 7.1 5.1 11.3 6.3l1.6.4c7.4 2 13.3 7.9 15.4 15.2l7.4 26.6c1.1 3.9 2.9 7.6 5.4 10.9l25.2 33.9c-16.2 14-31 24.5-44.2 31.4-44.4-35.7-69.8-88.5-69.8-145.3zm9.7 90.4c11.6 22.7 27.7 43.2 47.7 60.3-16.3 6-46.1 14-57.2 2.5-8.8-9-5.4-31.2 9.5-62.8zm64.1 101.2c-16 6.8-32.3 11.2-48.3 13.1-12.5 1.4-23.2 1.3-31.9-.4-10.2-2-17.3-6.3-21.1-12.6-5.5-9.3-6.5-27.3 11.5-62.2-2 14.3.5 25 7.6 32.3 6.8 6.9 16.6 9.3 27.2 9.3 24.4 0 52.4-13 52.8-13.2 29.6-14.5 66.4-46.2 109.4-94.1 30.4-33.8 56.1-67.2 68.7-84.1l6.7 6.1c-.2 0-.5 0-.7 0-1.7.1-3.3.4-4.9.9-7.9 2.4-13.4 9.3-14 17.5l-1.4 17.8c-.1 1.8.6 3.7 1.9 4.9 1.1 1 2.6 1.6 4 1.6.3 0 .7 0 1-.1l17.6-3c7.9-1.4 14.2-7.3 16-15.1.4-1.8.6-3.6.5-5.5 0-.2 0-.5-.1-.7l4.3 4c-23.4 40.7-87.3 132.5-206.8 183.5zm243.4-55.3c-35 32.8-80.8 50.8-129 50.8-20.5 0-40.6-3.2-59.8-9.6 92.5-54.4 143.6-130.1 163.7-165.3v-.1c1.7-2.5 2.9-5.3 3.4-8.2l3.6-18.3 10.1 8.2c-4.9 14.4-1.2 31 10.6 42l22.6 20.8c1.1 1 2.6 1.6 4.1 1.6h.3c1.6-.1 3.1-.8 4.2-2l22.8-25.4c-6.6 40.2-26.3 77.1-56.6 105.5zm60.4-127.7-31.4 35-18.1-16.7c-10.7-9.9-11.8-26.5-2.7-37.7 15.1-5.9 29.1-13.5 42-22.6.7 6.9 3.8 13.5 9.2 18.4 3.3 3 5.2 7.1 5.5 11.6.1 4.4-1.5 8.7-4.5 12z"></path>
                            <path d="m344.5 479.9c-4.4 0-8 3.6-8 8s3.6 8 8 8 8-3.6 8-8-3.6-8-8-8z"></path>
                            <path d="m356.6 450.7c-6.1 0-11 4.9-11 11s4.9 11 11 11 11-4.9 11-11-4.9-11-11-11zm0 12c-.5 0-1-.4-1-1s.4-1 1-1 1 .4 1 1-.5 1-1 1z"></path>
                            <path d="m40.7 55.3c4.4 0 8-3.6 8-8s-3.6-8-8-8-8 3.6-8 8 3.6 8 8 8z"></path>
                            <path d="m52.8 32.1c6.1 0 11-4.9 11-11s-4.9-11-11-11-11 4.9-11 11 4.9 11 11 11zm0-12c.5 0 1 .4 1 1s-.4 1-1 1c-.5 0-1-.4-1-1s.5-1 1-1z"></path>
                            <path d="m154.6 31.8c5.3 1.8 9.5 6 11.3 11.3.8 2.5 3.1 4.1 5.7 4.1s4.9-1.7 5.7-4.1c1.8-5.3 6-9.6 11.3-11.3 2.4-.8 4.1-3.1 4.1-5.7s-1.6-4.9-4.1-5.7c-5.3-1.8-9.5-6-11.3-11.3-.8-2.5-3.1-4.1-5.7-4.1s-4.9 1.7-5.7 4.1c-1.8 5.3-6 9.6-11.3 11.3-2.4.8-4.1 3.1-4.1 5.7s1.7 4.9 4.1 5.7zm17-8.9c1 1.1 2.1 2.2 3.2 3.2-1.1 1-2.2 2.1-3.2 3.2-1-1.1-2.1-2.2-3.2-3.2 1.1-1 2.2-2 3.2-3.2z"></path>
                            <path d="m237.9 480.2c-5.3-1.8-9.5-6-11.3-11.3-.8-2.5-3.1-4.1-5.7-4.1s-4.9 1.7-5.7 4.1c-1.8 5.3-6 9.6-11.3 11.3-2.4.8-4.1 3.1-4.1 5.7s1.6 4.9 4.1 5.7c5.3 1.8 9.5 6 11.3 11.3.8 2.5 3.1 4.1 5.7 4.1s4.9-1.7 5.7-4.1c1.8-5.3 6-9.6 11.3-11.3 2.4-.8 4.1-3.1 4.1-5.7s-1.7-4.9-4.1-5.7zm-17 8.9c-1-1.1-2.1-2.2-3.2-3.2 1.1-1 2.2-2.1 3.2-3.2 1 1.1 2.1 2.2 3.2 3.2-1.2 1-2.2 2-3.2 3.2z"></path>
                            <path d="m490.4 427.9c-5.3-1.8-9.5-6-11.3-11.3-.8-2.5-3.1-4.1-5.7-4.1s-4.9 1.7-5.7 4.1c-1.8 5.3-6 9.6-11.3 11.3-2.4.8-4.1 3.1-4.1 5.7s1.7 4.9 4.1 5.7c5.3 1.8 9.5 6 11.3 11.3.8 2.5 3.1 4.1 5.7 4.1s4.9-1.7 5.7-4.1c1.8-5.3 6-9.6 11.3-11.3 2.4-.8 4.1-3.1 4.1-5.7s-1.7-4.9-4.1-5.7zm-17 8.9c-1-1.1-2.1-2.2-3.2-3.2 1.1-1 2.2-2.1 3.2-3.2 1 1.1 2.1 2.2 3.2 3.2-1.2.9-2.2 2-3.2 3.2z"></path>
                            <path d="m197.1 380.5c-.9.7-1.9 1.5-2.8 2.2-2.6 2-3.1 5.8-1 8.4 1.2 1.5 2.9 2.3 4.7 2.3 1.3 0 2.6-.4 3.7-1.3 1-.8 1.9-1.5 2.9-2.3 2.6-2.1 3-5.8.9-8.4-2-2.5-5.8-3-8.4-.9z"></path>
                            <path d="m224.8 356.5c-4.8 4.5-9.8 9-14.8 13.3-2.5 2.2-2.8 6-.6 8.5 1.2 1.4 2.9 2.1 4.5 2.1 1.4 0 2.8-.5 3.9-1.5 5.1-4.4 10.2-9 15.2-13.7 2.4-2.3 2.5-6.1.2-8.5-2.2-2.4-6-2.5-8.4-.2z"></path>
                            <path d="m273.2 312.5c-2.6-2.1-6.3-1.7-8.4.9-8.7 10.7-18 21.1-27.5 30.8-2.3 2.4-2.3 6.2.1 8.5 1.2 1.1 2.7 1.7 4.2 1.7 1.6 0 3.1-.6 4.3-1.8 9.8-10 19.3-20.7 28.2-31.7 2.1-2.6 1.7-6.3-.9-8.4z"></path>
                            <path d="m412 171.5c16.6 0 30-13.5 30-30s-13.5-30-30-30-30 13.5-30 30 13.4 30 30 30zm0-48c9.9 0 18 8.1 18 18s-8.1 18-18 18-18-8.1-18-18 8-18 18-18z"></path>
                        </g>
                    </svg>
                </span>
            </div>
        </header>
        <ul>
            <li><a id="Student" class="active" href="#Student">תלמידים</a></li>
            <li><a id="Rules" href="#Rules">חוקים</a></li>
            <li><a id="Grade" href="#Grade">ציונים</a></li>
        </ul>

        <div id="GradesDiv" class="container">
            <div class="row">
                <div class="col col-12">
                    <!-- הכפתורים של אקסל -->
                    <form>
                        <input type="file" id="input" hidden />
                        <label for="input">טען מקובץ אקסל</label>
                    </form>
                    <a href="../download/פורמט ציונים.xlsx" download>
                        <label>הורד פורמט אקסל</label>
                    </a>

                    <br />
                    <table id="grid1"></table>
                </div>
            </div>
            <div id="StudExams"></div>
            <button id="gradesBtn">צפייה בגרף</button>
            <!--<form id="pForm">
        <table id="examsTable" class="display nowrap" style="width:100%">
            <thead>
                <tr>
                    <th></th>
                    <th>שם פרטי</th>
                    <th>שם משפחה</th>
                    <th>אימייל</th>
                </tr>
            </thead>
        </table>

    </form>-->
            <div id="editDiv">
                <form id="examForm">
                    <div class="form-group row">
                        <div class="form-group col-sm-3">
                            <label for="lastname"><span class="red-star"> </span>שם משפחה</label>
                            <input type="text" class="form-control" id="lastname" required />
                        </div>
                        <div class="form-group col-sm-3">
                            <label for="firsname"><span class="red-star"> </span>שם פרטי</label>
                            <input type="text" class="form-control" id="firsname" required />
                        </div>
                    </div>
                    <div class="form-group row">
                        <div class="form-group col-sm-3">
                            <label for="exam1"><span class="red-star"> </span>מבחן 1</label>
                            <input type="number" class="form-control examsClass" id="exam1" placeholder="הזן את הציון">
                        </div>
                        <div class="form-group col-sm-3">
                            <label for="exam2"><span class="red-star"> </span>מבחן 2</label>
                            <input type="number" class="form-control examsClass" id="exam2" placeholder="הזן את הציון">
                        </div>
                        <div class="form-group col-sm-3">
                            <label for="exam3"><span class="red-star"> </span>מבחן 3</label>
                            <input type="number" class="form-control examsClass" id="exam3" placeholder="הזן את הציון">
                        </div>
                    </div>
                    <div id="btnsRemark">
                        <button id="saveBTN" type="submit">שמור</button>
                        <!--<button id="cancleBTN" type="reset">ביטול</button>-->
                    </div>
                </form>
            </div>
            <button id="saveExcel" class="btn btn-primary btn-lg"> שמור נתונים</button>

        </div>


    </body>
</html>